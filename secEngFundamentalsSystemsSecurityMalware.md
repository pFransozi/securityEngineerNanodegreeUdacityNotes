# Security Engineer

## Malware As An Infection Vector

Malware infections can happen in multiple ways in a system. The usual way malware enters the system is through the internet and email. Malware serves as an entry point for the attacker. It opens up the gate for further infecting the larger network that the user is connected to.

Malware attacks can be of two types:

    * targeted: These attacks are highly targeted towards a user or the larger organization the user is a part of. For example, an environmental activist can be targeted by the fossil fuel industry through malware attacks to monitor their activities. Another example can be that of state-sponsored malware attacks where specialized malware is used to target critical industrial businesses or a country.
    * generic: Generic malware do not specifically target a specific user or group. The cybercriminals behind such attacks are usually financially motivated and the main intention of the attack is to either steal any sensitive data or to extort for money. One such example is that of Ransomware. Ransomware attacks take hostage of your computer system and its files and give you access after you have paid the ransom money, usually in the form of cryptocurrency.

What Makes Malware such a Big Security Threat? One of the main reasons malware is a big security threat is that it persists on the system and can lead to full control of your system. It's like a tracking system that can monitor every activity on the system. In addition to that, malware infections can laterally propagate into the larger network you are connected to. For example, if you are using your office laptop in a coffee shop and connected to its wifi, you can get infected by malware. Once you connect the laptop back to the office network, there is a possibility that the infection can spread across the network. One major example of this case is the NonPetya ransomware family which used an SMB exploit to spread across a larger network after infecting a single machine connected to that network.

Malware Scanning: There are two important ways of malware scanning. One is signature-based and the other is behavior-based. The signature-based detection technique involves scanning the entire filesystem against a known list of malware signatures and determining a match. Behavior-based detection techniques involve looking at certain characteristics of the file, and it doesn't rely on specific signature sets to determine a behavior as malware.

Signature-Based Scanning with ClamAV: ClamAV is an open-source antivirus tool that can be used to scan the filesystem for the presence of malware. ClamAV uses its definitions set or signature set and matches it against each scanned file. If a match is found, it gets marked as a malware file.

ClamAV has a simple architecture. It uses a scanner service called clamscan to scan the file against its database of rules and signatures. The database needs to be frequently updated using another service called freshclam which pulls the updated signatures from ClamAV's server.

Advance Malware Detection & Hunting with YARA

ClamAV works well for detecting generic malware families. It can also detect targeted malware binaries, but not until it receives the updated definitions from its servers. This creates a gap in the detection and response to a highly-targeted malware threat. In such scenarios, we can write our own malware detection rules using YARA.

YARA is a tool used to identify and classify malware through the use of its signature matching capability. It implements various file parsing capabilities and allows us to write rules that can match those patterns inside the parsed file.